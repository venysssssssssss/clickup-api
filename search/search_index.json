{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"In\u00edcio","text":"<p>Aqui est\u00e1 a vers\u00e3o modificada do guia, incluindo instru\u00e7\u00f5es para rodar o seu projeto atual usando <code>Poetry</code>, configurando o ambiente virtual e instalando as depend\u00eancias sem instalar o pacote raiz.</p>"},{"location":"#instalacao-do-pyenv","title":"Instala\u00e7\u00e3o do pyenv","text":""},{"location":"#linux","title":"Linux","text":"<ol> <li> <p>Instale as depend\u00eancias necess\u00e1rias:    <code>bash    sudo apt-get update    sudo apt-get install -y make build-essential libssl-dev zlib1g-dev libbz2-dev \\    libreadline-dev libsqlite3-dev wget curl llvm libncurses5-dev libncursesw5-dev \\    xz-utils tk-dev libffi-dev liblzma-dev python-openssl git</code></p> </li> <li> <p>Instale o pyenv:    <code>bash    curl https://pyenv.run | bash</code></p> </li> <li> <p>Configure o ambiente:    Adicione as seguintes linhas ao seu <code>~/.bashrc</code>:    <code>bash    export PATH=\"$HOME/.pyenv/bin:$PATH\"    eval \"$(pyenv init --path)\"    eval \"$(pyenv virtualenv-init -)\"</code></p> </li> <li> <p>Reinicie o terminal ou execute <code>source ~/.bashrc</code>.</p> </li> </ol>"},{"location":"#windows","title":"Windows","text":"<p>Para Windows, recomendamos usar o <code>pyenv-win</code>:</p> <ol> <li> <p>Instale o pyenv-win:    <code>powershell    pip install pyenv-win --target \"$HOME/.pyenv\"</code></p> </li> <li> <p>Configure o ambiente:    Adicione <code>$HOME/.pyenv/pyenv-win/bin</code> e <code>$HOME/.pyenv/pyenv-win/shims</code> ao seu PATH atrav\u00e9s das Configura\u00e7\u00f5es do Sistema.</p> </li> </ol>"},{"location":"#macos","title":"macOS","text":"<ol> <li> <p>Instale o Homebrew se ainda n\u00e3o estiver instalado:    <code>bash    /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"</code></p> </li> <li> <p>Instale o pyenv usando o Homebrew:    <code>bash    brew install pyenv</code></p> </li> <li> <p>Adicione o pyenv ao seu perfil:    <code>bash    echo 'if which pyenv &gt; /dev/null; then eval \"$(pyenv init -)\"; fi' &gt;&gt; ~/.zprofile</code></p> </li> <li> <p>Instale o Python desejado:    <code>bash    pyenv install 3.9.0</code></p> </li> </ol>"},{"location":"#instalacao-do-poetry","title":"Instala\u00e7\u00e3o do Poetry","text":""},{"location":"#universal-linux-windows-macos","title":"Universal (Linux, Windows, macOS)","text":"<ol> <li> <p>Instale o Poetry:    <code>bash    curl -sSL https://install.python-poetry.org | python3 -</code></p> </li> <li> <p>Configure o PATH (se necess\u00e1rio):    Certifique-se de que o diret\u00f3rio <code>~/.local/bin</code> est\u00e1 no seu PATH para acessar o bin\u00e1rio do Poetry.</p> </li> </ol>"},{"location":"#configuracao-do-projeto","title":"Configura\u00e7\u00e3o do Projeto","text":"<ol> <li> <p>Defina a vers\u00e3o do Python usando pyenv:    <code>bash    pyenv local 3.x.x</code></p> </li> <li> <p>Navegue at\u00e9 o diret\u00f3rio do seu projeto:    <code>bash    cd caminho_para_seu_projeto</code></p> </li> <li> <p>Inicialize o ambiente virtual usando Poetry:    <code>bash    poetry shell</code></p> </li> <li> <p>Instale as depend\u00eancias do projeto sem instalar o pacote raiz:    <code>bash    poetry install --no-root</code></p> </li> <li> <p>Execute o projeto:    <code>bash    python nome_do_script.py</code></p> </li> </ol> <p>Estas instru\u00e7\u00f5es ajudar\u00e3o voc\u00ea a configurar e executar seu projeto Python atual, utilizando as vers\u00f5es espec\u00edficas do Python definidas pelo <code>pyenv</code> e gerenciando depend\u00eancias com <code>Poetry</code>.</p>"},{"location":"api.pt/","title":"Documenta\u00e7\u00e3o da API ClickUp","text":"<p>Este documento fornece uma vis\u00e3o detalhada da classe <code>ClickUpAPI</code>, que \u00e9 utilizada para interagir com a API do ClickUp para gerenciar tarefas e obter dados espec\u00edficos de status.</p>"},{"location":"api.pt/#classe-clickupapi","title":"Classe: ClickUpAPI","text":""},{"location":"api.pt/#inicializador","title":"Inicializador","text":"<p>Inicializa uma inst\u00e2ncia da classe <code>ClickUpAPI</code>.</p>"},{"location":"api.pt/#parametros","title":"Par\u00e2metros:","text":"<ul> <li><code>api_key</code> (str): A chave de API do ClickUp.</li> <li><code>timezone</code> (str): O fuso hor\u00e1rio utilizado para converter as datas.</li> <li><code>redis_cache</code>: O objeto de cache Redis utilizado para armazenar os dados em cache.</li> </ul>"},{"location":"api.pt/#excecoes","title":"Exce\u00e7\u00f5es:","text":"<ul> <li>Lan\u00e7a <code>ValueError</code> se a chave de API n\u00e3o for fornecida.</li> </ul>"},{"location":"api.pt/#metodos","title":"M\u00e9todos","text":""},{"location":"api.pt/#async-fetch_clickup_dataurl-str-query-dict-dict","title":"<code>async fetch_clickup_data(url: str, query: Dict) -&gt; Dict</code>","text":"<p>Faz uma requisi\u00e7\u00e3o ass\u00edncrona para a API do ClickUp e retorna os dados em formato JSON.</p>"},{"location":"api.pt/#parametros_1","title":"Par\u00e2metros:","text":"<ul> <li><code>url</code> (str): A URL da API do ClickUp.</li> <li><code>query</code> (Dict): Os par\u00e2metros da consulta.</li> </ul>"},{"location":"api.pt/#retorna","title":"Retorna:","text":"<ul> <li><code>Dict</code>: Os dados da resposta em formato JSON.</li> </ul>"},{"location":"api.pt/#excecoes_1","title":"Exce\u00e7\u00f5es:","text":"<ul> <li>Lan\u00e7a <code>HTTPException</code> se ocorrer um erro na requisi\u00e7\u00e3o HTTP.</li> </ul>"},{"location":"api.pt/#async-fetch_all_tasksurl-str-query-dict-listdict","title":"<code>async fetch_all_tasks(url: str, query: Dict) -&gt; List[Dict]</code>","text":"<p>Faz uma requisi\u00e7\u00e3o ass\u00edncrona para a API do ClickUp e retorna todas as tarefas em formato de lista de dicion\u00e1rios.</p>"},{"location":"api.pt/#parametros_2","title":"Par\u00e2metros:","text":"<ul> <li><code>url</code> (str): A URL da API do ClickUp.</li> <li><code>query</code> (Dict): Os par\u00e2metros da consulta.</li> </ul>"},{"location":"api.pt/#retorna_1","title":"Retorna:","text":"<ul> <li><code>List[Dict]</code>: Uma lista de dicion\u00e1rios contendo as informa\u00e7\u00f5es das tarefas.</li> </ul>"},{"location":"api.pt/#async-fetch_time_in_statustask_id-str-client-httpxasyncclient-dict","title":"<code>async fetch_time_in_status(task_id: str, client: httpx.AsyncClient) -&gt; Dict</code>","text":"<p>Obt\u00e9m o tempo gasto em cada status de uma tarefa espec\u00edfica.</p>"},{"location":"api.pt/#parametros_3","title":"Par\u00e2metros:","text":"<ul> <li><code>task_id</code> (str): O ID da tarefa.</li> <li><code>client</code> (httpx.AsyncClient): O cliente HTTP utilizado para fazer a requisi\u00e7\u00e3o.</li> </ul>"},{"location":"api.pt/#retorna_2","title":"Retorna:","text":"<ul> <li><code>Dict</code>: Os dados do tempo em cada status da tarefa em formato JSON.</li> </ul>"},{"location":"api.pt/#async-fetch_all_time_in_statustasks-listdict-none","title":"<code>async fetch_all_time_in_status(tasks: List[Dict]) -&gt; None</code>","text":"<p>Obt\u00e9m o tempo em status para todas as tarefas fornecidas.</p>"},{"location":"api.pt/#parametros_4","title":"Par\u00e2metros:","text":"<ul> <li><code>tasks</code> (List[Dict]): Uma lista de dicion\u00e1rios contendo as informa\u00e7\u00f5es das tarefas.</li> </ul>"},{"location":"api.pt/#filter_taskstasks-listdict-listdict-listdict","title":"<code>filter_tasks(tasks: List[Dict]) -&gt; (List[Dict], List[Dict])</code>","text":"<p>Filtra as tarefas retornando apenas as informa\u00e7\u00f5es relevantes e o hist\u00f3rico de status.</p>"},{"location":"api.pt/#parametros_5","title":"Par\u00e2metros:","text":"<ul> <li><code>tasks</code> (List[Dict]): Uma lista de dicion\u00e1rios contendo as informa\u00e7\u00f5es das tarefas.</li> </ul>"},{"location":"api.pt/#retorna_3","title":"Retorna:","text":"<ul> <li><code>Tuple[List[Dict], List[Dict]]</code>: Uma tupla contendo a lista de tarefas filtradas e o hist\u00f3rico de status.</li> </ul>"},{"location":"api.pt/#metodos-estaticos","title":"M\u00e9todos Est\u00e1ticos","text":""},{"location":"api.pt/#convert_timetime_in_minutes-int-str","title":"<code>convert_time(time_in_minutes: int) -&gt; str</code>","text":"<p>Converte o tempo em minutos para uma string formatada.</p>"},{"location":"api.pt/#parametros_6","title":"Par\u00e2metros:","text":"<ul> <li><code>time_in_minutes</code> (int): O tempo em minutos.</li> </ul>"},{"location":"api.pt/#retorna_4","title":"Retorna:","text":"<ul> <li><code>str</code>: O tempo formatado em minutos, horas ou dias.</li> </ul>"},{"location":"api.pt/#parse_task_texttask_text-str-str","title":"<code>parse_task_text(task_text: str) -&gt; str</code>","text":"<p>Remove quebras de linha e caracteres especiais do texto da tarefa.</p>"},{"location":"api.pt/#parametros_7","title":"Par\u00e2metros:","text":"<ul> <li><code>task_text</code> (str): O texto da tarefa.</li> </ul>"},{"location":"api.pt/#retorna_5","title":"Retorna:","text":"<ul> <li><code>str</code>: O texto da tarefa formatado.</li> </ul>"},{"location":"api.pt/#extract_field_valuestask_text-str-dictstr-str","title":"<code>extract_field_values(task_text: str) -&gt; Dict[str, str]</code>","text":"<p>Extrai os valores dos campos do texto da tarefa.</p>"},{"location":"api.pt/#parametros_8","title":"Par\u00e2metros:","text":"<ul> <li><code>task_text</code> (str): O texto da tarefa.</li> </ul>"},{"location":"api.pt/#retorna_6","title":"Retorna:","text":"<ul> <li><code>Dict[str, str]</code>: Um dicion\u00e1rio contendo os valores dos campos extra\u00eddos do texto da tarefa.</li> </ul>"},{"location":"api.pt/#convert_status_historystatus_history-dict-dict","title":"<code>convert_status_history(status_history: Dict) -&gt; Dict</code>","text":"<p>Converte o hist\u00f3rico de status em um formato mais leg\u00edvel.</p>"},{"location":"api.pt/#parametros_9","title":"Par\u00e2metros:","text":"<ul> <li><code>status_history</code> (Dict): O hist\u00f3rico de status da tarefa.</li> </ul>"},{"location":"api.pt/#retorna_7","title":"Retorna:","text":"<ul> <li><code>Dict</code>: O hist\u00f3rico de status convertido em formato mais leg\u00edvel.</li> </ul>"},{"location":"api.pt/#async-get_taskslist_id-str-listdictstr-unionstr-none","title":"<code>async get_tasks(list_id: str) -&gt; List[Dict[str, Union[str, None]]]</code>","text":"<p>Obt\u00e9m as tarefas de uma lista espec\u00edfica.</p>"},{"location":"api.pt/#parametros_10","title":"Par\u00e2metros:","text":"<ul> <li><code>list_id</code> (str): O ID da lista.</li> </ul>"},{"location":"api.pt/#retorna_8","title":"Retorna:","text":"<ul> <li><code>List[Dict[str, Union[str, None]]]</code>: Uma lista de dicion\u00e1rios contendo as informa\u00e7\u00f5es das tarefas.</li> </ul>"},{"location":"backup/","title":"Backup","text":"<pre><code># Documenta\u00e7\u00e3o do Projeto\n\nEste projeto utiliza o framework FastAPI para criar uma API que interage com o servi\u00e7o ClickUp e armazena dados em um banco de dados PostgreSQL. A aplica\u00e7\u00e3o tamb\u00e9m faz uso de um cache Redis para melhorar a performance.\n\n## Arquivo `src/main.py`\n\n### Depend\u00eancias\n\n```python\nimport asyncio\nimport pandas as pd\nimport pytz\nfrom fastapi import FastAPI\n\nfrom src.api.clickup_api import ClickUpAPI\nfrom src.cache.redis_cache import RedisCache\nfrom src.config import settings\nfrom src.db.postgres import PostgresDB\n</code></pre>"},{"location":"backup/#inicializacao-da-aplicacao","title":"Inicializa\u00e7\u00e3o da Aplica\u00e7\u00e3o","text":"<p>A aplica\u00e7\u00e3o FastAPI \u00e9 inicializada da seguinte forma:</p> <pre><code>app = FastAPI()\n</code></pre>"},{"location":"backup/#inicializacao-das-instancias-de-cache-api-e-banco-de-dados","title":"Inicializa\u00e7\u00e3o das Inst\u00e2ncias de Cache, API e Banco de Dados","text":"<p>Criamos inst\u00e2ncias das classes <code>RedisCache</code>, <code>ClickUpAPI</code> e <code>PostgresDB</code> utilizando configura\u00e7\u00f5es definidas em <code>settings</code>.</p> <pre><code>redis_cache = RedisCache(settings.REDIS_URL)\nclickup_api = ClickUpAPI(settings.API_KEY, settings.TIMEZONE, redis_cache)\npostgres_db = PostgresDB(\n    settings.DB_HOST,\n    settings.DB_PORT,\n    settings.DB_NAME,\n    settings.DB_USER,\n    settings.DB_PASS,\n    settings.DB_SCHEMA,\n)\n</code></pre>"},{"location":"backup/#endpoint-get_data_organizedlist_id","title":"Endpoint: <code>/get_data_organized/{list_id}</code>","text":"<p>Este endpoint obt\u00e9m e organiza os dados das tarefas de uma lista espec\u00edfica no ClickUp.</p>"},{"location":"backup/#definicao","title":"Defini\u00e7\u00e3o","text":"<pre><code>@app.get('/get_data_organized/{list_id}')\nasync def get_data_organized(list_id: str):\n    \"\"\"\n    Obt\u00e9m e organiza os dados das tarefas de uma lista espec\u00edfica no ClickUp.\n\n    Args:\n        list_id (str): O ID da lista no ClickUp.\n\n    Returns:\n        list: Uma lista de tarefas filtradas.\n    \"\"\"\n    print(f'Fetching tasks for list ID: {list_id}')\n    tasks = await clickup_api.get_tasks(list_id)\n    filtered_tasks, status_history_data = clickup_api.filter_tasks(tasks)\n\n    # Converting the list of dictionaries to pandas DataFrames\n    df_tasks = pd.DataFrame(filtered_tasks)\n    df_status_history = pd.DataFrame(status_history_data)\n\n    # Saving the DataFrames to PostgreSQL\n    if list_id == '192959544':\n        postgres_db.save_to_postgres(df_tasks, 'lista_dados_inovacao')\n        postgres_db.save_to_postgres(df_status_history, 'status_history_inovacao')\n    elif list_id == '174940580':\n        postgres_db.save_to_postgres(df_tasks, 'lista_dados_negocios')\n        postgres_db.save_to_postgres(df_status_history, 'status_history_negocios')\n\n    return filtered_tasks\n</code></pre>"},{"location":"backup/#descricao","title":"Descri\u00e7\u00e3o","text":"<ul> <li>Args:</li> <li> <p><code>list_id</code> (str): O ID da lista no ClickUp.</p> </li> <li> <p>Returns:</p> </li> <li><code>list</code>: Uma lista de tarefas filtradas.</li> </ul>"},{"location":"backup/#funcionamento","title":"Funcionamento","text":"<ol> <li>O endpoint recebe um <code>list_id</code> como par\u00e2metro.</li> <li>Utiliza o <code>clickup_api</code> para obter as tarefas da lista especificada.</li> <li>Filtra as tarefas e obt\u00e9m os dados do hist\u00f3rico de status.</li> <li>Converte as listas de dicion\u00e1rios em DataFrames do pandas.</li> <li>Salva os DataFrames em tabelas espec\u00edficas no PostgreSQL, dependendo do <code>list_id</code>.</li> <li>Retorna a lista de tarefas filtradas.</li> </ol>"},{"location":"backup/#condicional-list_id","title":"Condicional <code>list_id</code>","text":"<ul> <li>Se <code>list_id</code> for '192959544', os dados s\u00e3o salvos nas tabelas <code>lista_dados_inovacao</code> e <code>status_history_inovacao</code>.</li> <li>Se <code>list_id</code> for '174940580', os dados s\u00e3o salvos nas tabelas <code>lista_dados_negocios</code> e <code>status_history_negocios</code>.</li> </ul>"},{"location":"backup/#consideracoes-finais","title":"Considera\u00e7\u00f5es Finais","text":"<p>Este arquivo principal (<code>src/main.py</code>) configura e inicializa os componentes principais da aplica\u00e7\u00e3o, define o endpoint e implementa a l\u00f3gica necess\u00e1ria para obter, filtrar e salvar os dados das tarefas do ClickUp. A documenta\u00e7\u00e3o detalhada aqui visa fornecer uma compreens\u00e3o clara e acess\u00edvel de como o c\u00f3digo funciona, mesmo para aqueles que n\u00e3o t\u00eam familiaridade com programa\u00e7\u00e3o. ```</p> <p>Espero que isso atenda \u00e0s suas necessidades. Se precisar de mais alguma coisa, \u00e9 s\u00f3 avisar.</p>"},{"location":"docker.pt/","title":"Documenta\u00e7\u00e3o do Dockerfile para Aplica\u00e7\u00e3o FastAPI com Poetry","text":"<p>Este Dockerfile \u00e9 configurado para construir uma imagem Docker para uma aplica\u00e7\u00e3o FastAPI, utilizando o gerenciador de pacotes Poetry para gerenciar as depend\u00eancias do Python.</p>"},{"location":"docker.pt/#estrutura-do-dockerfile","title":"Estrutura do Dockerfile","text":"<pre><code># Utiliza a imagem oficial do Python 3.10.0 como base\nFROM python:3.10.0\n\n# Instala o gerenciador de pacotes Poetry\nRUN pip install poetry\n\n# Copia o arquivo pyproject.toml e o arquivo de bloqueio poetry.lock para o diret\u00f3rio de trabalho\nCOPY . /src\n\n# Define o diret\u00f3rio de trabalho dentro do container\nWORKDIR /src\n\n# Instala as depend\u00eancias do projeto definidas no Poetry, exceto o pr\u00f3prio projeto (op\u00e7\u00e3o --no-root)\nRUN poetry install --no-root\n\n# Copia o restante do c\u00f3digo da aplica\u00e7\u00e3o para o diret\u00f3rio de trabalho\nCOPY . .\n\n# Exp\u00f5e a porta 8000, configurada para a aplica\u00e7\u00e3o FastAPI acessar a rede\nEXPOSE 8000\n\n# Define o comando padr\u00e3o para iniciar a aplica\u00e7\u00e3o usando Poetry e Uvicorn\nCMD [\"poetry\", \"run\", \"uvicorn\", \"src.main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]\n</code></pre>"},{"location":"gh_actions/","title":"GitHub Actions","text":"<p>Aqui est\u00e1 a documenta\u00e7\u00e3o do workflow em formato Markdown:</p>"},{"location":"gh_actions/#github-actions-workflow-schedule-api-requests","title":"GitHub Actions Workflow: Schedule API Requests","text":"<p>Este workflow \u00e9 configurado para fazer requisi\u00e7\u00f5es a duas APIs diferentes a cada 3 horas, utilizando o <code>cron</code> agendador.</p>"},{"location":"gh_actions/#descricao","title":"Descri\u00e7\u00e3o","text":"<p>O workflow <code>Schedule API Requests</code> \u00e9 executado em um ambiente <code>ubuntu-latest</code> e possui um \u00fanico job <code>call_apis</code> que realiza duas requisi\u00e7\u00f5es HTTP usando <code>curl</code>. Se qualquer uma das requisi\u00e7\u00f5es falhar, o job ser\u00e1 interrompido e um erro ser\u00e1 reportado.</p>"},{"location":"gh_actions/#definicao-do-workflow","title":"Defini\u00e7\u00e3o do Workflow","text":"<pre><code>name: Schedule API Requests\n\non:\n  schedule:\n    - cron: '0 */3 * * *'  # Executa a cada 3 horas\n\njobs:\n  call_apis:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Make API request to get_data_organized/192959544\n      run: |\n        echo \"Fetching: ${{ secrets.API_URL_1_INO }}\"\n        curl -s -o /dev/null -w \"%{http_code}\" \"${{ secrets.API_URL_1_INO }}\"\n        if [ $? -ne 0 ]; then\n          echo \"Failed to fetch ${{ secrets.API_URL_1_INO }}\"\n          exit 1\n        fi\n    - name: Make API request to get_data_organized/174940580\n      run: |\n        echo \"Fetching: ${{ secrets.API_URL_2_NEG }}\"\n        curl -s -o /dev/null -w \"%{http_code}\" \"${{ secrets.API_URL_2_NEG }}\"\n        if [ $? -ne 0 ]; then\n          echo \"Failed to fetch ${{ secrets.API_URL_2_NEG }}\"\n          exit 1\n        fi\n</code></pre>"},{"location":"gh_actions/#explicacao-das-configuracoes","title":"Explica\u00e7\u00e3o das Configura\u00e7\u00f5es","text":""},{"location":"gh_actions/#triggers","title":"Triggers","text":"<ul> <li><code>schedule</code>: O workflow \u00e9 agendado para executar a cada 3 horas usando uma express\u00e3o cron (<code>0 */3 * * *</code>).</li> </ul>"},{"location":"gh_actions/#jobs","title":"Jobs","text":""},{"location":"gh_actions/#call_apis","title":"<code>call_apis</code>","text":"<ul> <li><code>runs-on</code>: Define o ambiente de execu\u00e7\u00e3o como <code>ubuntu-latest</code>.</li> </ul>"},{"location":"gh_actions/#steps","title":"Steps","text":"<ol> <li>Make API request to get_data_organized/192959544</li> <li>Faz uma requisi\u00e7\u00e3o HTTP \u00e0 URL armazenada no secret <code>API_URL_1_INO</code>.</li> <li>Utiliza <code>curl</code> para fazer a requisi\u00e7\u00e3o de forma silenciosa (<code>-s</code>), ignorando a sa\u00edda padr\u00e3o e registrando apenas o c\u00f3digo de status HTTP (<code>-o /dev/null -w \"%{http_code}\"</code>).</li> <li>Verifica se o comando <code>curl</code> foi bem-sucedido (<code>if [ $? -ne 0 ]; then</code>).</li> <li> <p>Em caso de falha, imprime uma mensagem de erro e interrompe a execu\u00e7\u00e3o (<code>exit 1</code>).</p> </li> <li> <p>Make API request to get_data_organized/174940580</p> </li> <li>Faz uma requisi\u00e7\u00e3o HTTP \u00e0 URL armazenada no secret <code>API_URL_2_NEG</code> seguindo os mesmos passos descritos acima.</li> </ol>"},{"location":"gh_actions/#configuracao-de-secrets","title":"Configura\u00e7\u00e3o de Secrets","text":"<ul> <li><code>API_URL_1_INO</code>: URL da primeira API a ser chamada.</li> <li><code>API_URL_2_NEG</code>: URL da segunda API a ser chamada.</li> </ul>"},{"location":"main.pt/","title":"Estrutura do Projeto e Arquivo <code>main.py</code>","text":""},{"location":"main.pt/#estrutura-do-projeto","title":"Estrutura do Projeto","text":"<pre><code>project/\n\u2502\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 api/\n\u2502   \u2502   \u2514\u2500\u2500 clickup_api.py\n\u2502   \u251c\u2500\u2500 cache/\n\u2502   \u2502   \u2514\u2500\u2500 redis_cache.py\n\u2502   \u251c\u2500\u2500 config/\n\u2502   \u2502   \u2514\u2500\u2500 settings.py\n\u2502   \u251c\u2500\u2500 db/\n\u2502   \u2502   \u2514\u2500\u2500 postgres.py\n\u2502   \u2514\u2500\u2500 main.py\n\u2502\n\u2514\u2500\u2500 requirements.txt\n</code></pre>"},{"location":"main.pt/#arquivo-mainpy","title":"Arquivo <code>main.py</code>","text":"<pre><code>import asyncio\nimport pandas as pd\nimport pytz\nfrom fastapi import FastAPI\nfrom src.api.clickup_api import ClickUpAPI\nfrom src.cache.redis_cache import RedisCache\nfrom src.config import settings\nfrom src.db.postgres import PostgresDB\n\napp = FastAPI()\n\nredis_cache = RedisCache(settings.REDIS_URL)\nclickup_api = ClickUpAPI(settings.API_KEY, settings.TIMEZONE, redis_cache)\npostgres_db = PostgresDB(\n    settings.DB_HOST,\n    settings.DB_PORT,\n    settings.DB_NAME,\n    settings.DB_USER,\n    settings.DB_PASS,\n    settings.DB_SCHEMA,\n)\n\n@app.get('/get_data_organized/{list_id}')\nasync def get_data_organized(list_id: str):\n    \"\"\"\n    Obt\u00e9m e organiza os dados das tarefas de uma lista espec\u00edfica no ClickUp.\n\n    Args:\n        list_id (str): O ID da lista no ClickUp.\n\n    Returns:\n        list: Uma lista de tarefas filtradas.\n    \"\"\"\n    print(f'Fetching tasks for list ID: {list_id}')\n    tasks = await clickup_api.get_tasks(list_id)\n    filtered_tasks, status_history_data = clickup_api.filter_tasks(tasks)\n\n    # Converting the list of dictionaries to pandas DataFrames\n    df_tasks = pd.DataFrame(filtered_tasks)\n    df_status_history = pd.DataFrame(status_history_data)\n\n    # Saving the DataFrames to PostgreSQL\n    if list_id == '192959544':\n        postgres_db.save_to_postgres(df_tasks, 'lista_dados_inovacao')\n        postgres_db.save_to_postgres(\n            df_status_history, 'status_history_inovacao'\n        )\n    elif list_id == '174940580':\n        postgres_db.save_to_postgres(df_tasks, 'lista_dados_negocios')\n        postgres_db.save_to_postgres(\n            df_status_history, 'status_history_negocios'\n        )\n\n    return filtered_tasks\n</code></pre>"},{"location":"main.pt/#endpoints","title":"Endpoints","text":""},{"location":"main.pt/#get-get_data_organizedlist_id","title":"GET /get_data_organized/{list_id}","text":"<p>Obt\u00e9m e organiza os dados das tarefas de uma lista espec\u00edfica no ClickUp.</p>"},{"location":"main.pt/#parametros","title":"Par\u00e2metros","text":"<ul> <li><code>list_id</code> (str): O ID da lista no ClickUp.</li> </ul>"},{"location":"main.pt/#retorno","title":"Retorno","text":"<ul> <li><code>list</code>: Uma lista de tarefas filtradas.</li> </ul>"},{"location":"main.pt/#descricao-dos-modulos","title":"Descri\u00e7\u00e3o dos M\u00f3dulos","text":""},{"location":"main.pt/#clickup_api","title":"clickup_api","text":"<p>M\u00f3dulo personalizado para interagir com a API do ClickUp. Respons\u00e1vel por obter e filtrar tarefas.</p>"},{"location":"main.pt/#redis_cache","title":"redis_cache","text":"<p>M\u00f3dulo personalizado para implementar o cache utilizando Redis, melhorando a performance ao evitar requisi\u00e7\u00f5es redundantes.</p>"},{"location":"main.pt/#settings","title":"settings","text":"<p>M\u00f3dulo que cont\u00e9m as configura\u00e7\u00f5es do projeto, como URLs de conex\u00e3o e chaves de API.</p>"},{"location":"main.pt/#postgres","title":"postgres","text":"<p>M\u00f3dulo personalizado para interagir com o banco de dados PostgreSQL. Inclui fun\u00e7\u00f5es para salvar DataFrames do pandas no banco de dados.</p>"},{"location":"main.pt/#funcionalidades","title":"Funcionalidades","text":"<ul> <li>Integra\u00e7\u00e3o com ClickUp: Obt\u00e9m dados de tarefas de listas espec\u00edficas.</li> <li>Filtragem de Tarefas: Filtra tarefas e hist\u00f3rico de status.</li> <li>Armazenamento no PostgreSQL: Converte dados em DataFrames e armazena no banco de dados.</li> </ul>"},{"location":"main.pt/#consideracoes-finais","title":"Considera\u00e7\u00f5es Finais","text":"<p>Este projeto demonstra uma integra\u00e7\u00e3o eficiente entre FastAPI, ClickUp e PostgreSQL, utilizando boas pr\u00e1ticas de programa\u00e7\u00e3o ass\u00edncrona e manipula\u00e7\u00e3o de dados com pandas.</p>"},{"location":"postgre.pt/","title":"Documenta\u00e7\u00e3o da Classe PostgresDB","text":"<p>Esta documenta\u00e7\u00e3o fornece detalhes sobre a classe <code>PostgresDB</code>, projetada para interagir com um banco de dados PostgreSQL, permitindo opera\u00e7\u00f5es como verificar a exist\u00eancia de tabelas e salvar dados de um DataFrame do pandas.</p>"},{"location":"postgre.pt/#classe-postgresdb","title":"Classe: PostgresDB","text":""},{"location":"postgre.pt/#inicializador","title":"Inicializador","text":"<p>Inicializa uma inst\u00e2ncia da classe <code>PostgresDB</code>, configurando a conex\u00e3o com o banco de dados PostgreSQL.</p>"},{"location":"postgre.pt/#parametros","title":"Par\u00e2metros:","text":"<ul> <li><code>host</code> (str): O nome do host ou endere\u00e7o IP do servidor PostgreSQL.</li> <li><code>port</code> (str): O n\u00famero da porta do servidor PostgreSQL.</li> <li><code>dbname</code> (str): O nome do banco de dados PostgreSQL.</li> <li><code>user</code> (str): O nome de usu\u00e1rio para autentica\u00e7\u00e3o no servidor PostgreSQL.</li> <li><code>password</code> (str): A senha para autentica\u00e7\u00e3o no servidor PostgreSQL.</li> <li><code>schema</code> (str, opcional): O esquema a ser usado no banco de dados PostgreSQL. Padr\u00e3o \u00e9 'public'.</li> </ul>"},{"location":"postgre.pt/#atributos","title":"Atributos:","text":"<ul> <li><code>schema</code> (str): O esquema usado no banco de dados.</li> <li><code>database_url</code> (str): A URL para conex\u00e3o com o banco de dados.</li> <li><code>engine</code> (sqlalchemy.engine.Engine): O engine SQLAlchemy para conex\u00e3o com o banco de dados.</li> </ul>"},{"location":"postgre.pt/#metodos","title":"M\u00e9todos","text":""},{"location":"postgre.pt/#save_to_postgresdf-pddataframe-table_name-str","title":"<code>save_to_postgres(df: pd.DataFrame, table_name: str)</code>","text":"<p>Salva um DataFrame do pandas em uma tabela do PostgreSQL. Se a tabela j\u00e1 existir, os dados ser\u00e3o substitu\u00eddos.</p>"},{"location":"postgre.pt/#parametros_1","title":"Par\u00e2metros:","text":"<ul> <li><code>df</code> (pd.DataFrame): O DataFrame a ser salvo.</li> <li><code>table_name</code> (str): O nome da tabela onde o DataFrame ser\u00e1 salvo.</li> </ul>"},{"location":"postgre.pt/#excecoes","title":"Exce\u00e7\u00f5es:","text":"<ul> <li><code>SQLAlchemyError</code>: Lan\u00e7ada se ocorrer um erro durante a opera\u00e7\u00e3o de salvamento no banco de dados.</li> </ul>"},{"location":"postgre.pt/#comportamento","title":"Comportamento:","text":"<ul> <li>A fun\u00e7\u00e3o verifica primeiro se a tabela existe utilizando o m\u00e9todo <code>table_exists</code>. Se existir, utiliza o par\u00e2metro <code>replace</code> para a fun\u00e7\u00e3o <code>to_sql</code>, caso contr\u00e1rio, usa <code>fail</code>.</li> </ul>"},{"location":"postgre.pt/#table_existstable_name-str-bool","title":"<code>table_exists(table_name: str) -&gt; bool</code>","text":"<p>Verifica se uma tabela especificada existe no esquema configurado do banco de dados PostgreSQL.</p>"},{"location":"postgre.pt/#parametros_2","title":"Par\u00e2metros:","text":"<ul> <li><code>table_name</code> (str): O nome da tabela a ser verificada.</li> </ul>"},{"location":"postgre.pt/#retorna","title":"Retorna:","text":"<ul> <li><code>bool</code>: <code>True</code> se a tabela existir, <code>False</code> caso contr\u00e1rio.</li> </ul>"},{"location":"postgre.pt/#detalhes","title":"Detalhes:","text":"<ul> <li>A consulta SQL verificando a exist\u00eancia da tabela \u00e9 executada atrav\u00e9s do engine SQLAlchemy, utilizando o esquema definido no inicializador da classe.</li> </ul>"},{"location":"postgre.pt/#exemplo-de-uso","title":"Exemplo de Uso","text":"<pre><code># Configura\u00e7\u00e3o da conex\u00e3o com o banco de dados\ndb = PostgresDB(\n    host=\"localhost\",\n    port=\"5432\",\n    dbname=\"meu_banco\",\n    user=\"usuario\",\n    password=\"senha\",\n    schema=\"meu_esquema\"\n)\n\n# DataFrame exemplo para salvar\ndf = pd.DataFrame({\n    \"coluna1\": [1, 2, 3],\n    \"coluna2\": [\"A\", \"B\", \"C\"]\n})\n\n# Salvar DataFrame no PostgreSQL\ndb.save_to_postgres(df, \"minha_tabela\")\n</code></pre>"},{"location":"redis.pt/","title":"Documenta\u00e7\u00e3o da Classe RedisCache","text":"<p>Este documento fornece uma vis\u00e3o detalhada da classe <code>RedisCache</code>, utilizada para interagir com um banco de dados Redis para armazenar e recuperar dados de forma eficiente.</p>"},{"location":"redis.pt/#classe-rediscache","title":"Classe: RedisCache","text":""},{"location":"redis.pt/#inicializador","title":"Inicializador","text":"<p>Inicializa uma inst\u00e2ncia da classe <code>RedisCache</code>, configurando a conex\u00e3o com um servidor Redis especificado pela URL.</p>"},{"location":"redis.pt/#parametros","title":"Par\u00e2metros","text":"<ul> <li><code>redis_url</code> (str): A URL de conex\u00e3o com o Redis.</li> </ul>"},{"location":"redis.pt/#comportamento","title":"Comportamento","text":"<ul> <li>Ao inicializar, a conex\u00e3o com o Redis \u00e9 testada automaticamente. Se a conex\u00e3o falhar, uma exce\u00e7\u00e3o HTTP ser\u00e1 lan\u00e7ada.</li> </ul>"},{"location":"redis.pt/#metodos","title":"M\u00e9todos","text":""},{"location":"redis.pt/#test_redis_connection","title":"<code>test_redis_connection()</code>","text":"<p>Testa a conex\u00e3o com o servidor Redis para garantir que est\u00e1 ativa e funcional.</p>"},{"location":"redis.pt/#excecoes","title":"Exce\u00e7\u00f5es","text":"<ul> <li><code>HTTPException</code>: Lan\u00e7ada se a conex\u00e3o com o Redis falhar, com o status code 500 e uma mensagem detalhada do erro.</li> </ul>"},{"location":"redis.pt/#efeitos-colaterais","title":"Efeitos Colaterais","text":"<ul> <li>Imprime uma mensagem no console indicando sucesso ou falha na conex\u00e3o.</li> </ul>"},{"location":"redis.pt/#getkey-str-unionlist-none","title":"<code>get(key: str) -&gt; Union[List, None]</code>","text":"<p>Recupera os dados armazenados no Redis associados \u00e0 chave especificada.</p>"},{"location":"redis.pt/#parametros_1","title":"Par\u00e2metros","text":"<ul> <li><code>key</code> (str): A chave dos dados a serem obtidos.</li> </ul>"},{"location":"redis.pt/#retorna","title":"Retorna","text":"<ul> <li><code>Union[List, None]</code>: Retorna os dados deserializados armazenados sob a chave especificada, ou <code>None</code> se n\u00e3o existirem dados para a chave.</li> </ul>"},{"location":"redis.pt/#comportamento_1","title":"Comportamento","text":"<ul> <li>Se ocorrer um erro ao acessar o Redis, uma mensagem de erro \u00e9 impressa e <code>None</code> \u00e9 retornado.</li> </ul>"},{"location":"redis.pt/#setkey-str-data-list-ttl-int-600","title":"<code>set(key: str, data: List, ttl: int = 600)</code>","text":"<p>Armazena os dados no Redis associados a uma chave, com um tempo de vida especificado.</p>"},{"location":"redis.pt/#parametros_2","title":"Par\u00e2metros","text":"<ul> <li><code>key</code> (str): A chave sob a qual os dados ser\u00e3o armazenados.</li> <li><code>data</code> (List): Os dados a serem armazenados.</li> <li><code>ttl</code> (int, opcional): O tempo de vida dos dados em segundos. O padr\u00e3o \u00e9 600 segundos (10 minutos).</li> </ul>"},{"location":"redis.pt/#comportamento_2","title":"Comportamento","text":"<ul> <li>Armazena os dados serializados no Redis. Se ocorrer um erro durante o armazenamento, uma mensagem de erro \u00e9 impressa.</li> </ul>"},{"location":"redis.pt/#excecoes-comuns","title":"Exce\u00e7\u00f5es Comuns","text":"<ul> <li><code>redis.RedisError</code>: Capturada e tratada dentro dos m\u00e9todos <code>get</code> e <code>set</code>, resultando na impress\u00e3o de mensagens de erro no console em caso de falha nas opera\u00e7\u00f5es.</li> </ul>"},{"location":"redis.pt/#uso","title":"Uso","text":"<p>A classe <code>RedisCache</code> \u00e9 projetada para ser utilizada em aplica\u00e7\u00f5es que requerem armazenamento de dados r\u00e1pido e eficiente com capacidade de expira\u00e7\u00e3o autom\u00e1tica. Ela \u00e9 particularmente \u00fatil em cen\u00e1rios de cache de dados para aplica\u00e7\u00f5es web, onde a velocidade de acesso aos dados \u00e9 cr\u00edtica.</p>"},{"location":"routes.pt/","title":"Documenta\u00e7\u00e3o do Endpoint <code>/get_data_organized/{list_id}</code>","text":"<p>Este documento detalha o endpoint <code>get_data_organized/{list_id}</code>, que \u00e9 respons\u00e1vel por recuperar e organizar dados de tarefas do ClickUp utilizando uma API personalizada e armazenamento em cache via Redis.</p>"},{"location":"routes.pt/#descricao","title":"Descri\u00e7\u00e3o","text":"<p>O endpoint recupera as tarefas de uma lista espec\u00edfica no ClickUp, filtra essas tarefas para dados relevantes, e retorna esses dados organizados para o usu\u00e1rio. Ele valida a lista e configura\u00e7\u00f5es de ambiente antes de executar as opera\u00e7\u00f5es.</p>"},{"location":"routes.pt/#endpoint-get-get_data_organizedlist_id","title":"Endpoint: <code>GET /get_data_organized/{list_id}</code>","text":""},{"location":"routes.pt/#parametros","title":"Par\u00e2metros","text":"<ul> <li><code>list_id</code> (str): O identificador da lista de tarefas no ClickUp. Deve ser um valor alfanum\u00e9rico para garantir que \u00e9 um ID v\u00e1lido.</li> </ul>"},{"location":"routes.pt/#respostas","title":"Respostas","text":"<ul> <li>200 OK: Retorna os dados das tarefas filtrados e organizados.</li> <li>400 Bad Request: Retorna uma mensagem de erro se o <code>list_id</code> n\u00e3o for alfanum\u00e9rico.</li> <li>500 Internal Server Error: Retorna uma mensagem de erro se a chave API ou a URL do Redis n\u00e3o estiverem configuradas corretamente, ou se ocorrer um erro durante a recupera\u00e7\u00e3o ou processamento dos dados.</li> </ul>"},{"location":"routes.pt/#validacoes-e-configuracoes","title":"Valida\u00e7\u00f5es e Configura\u00e7\u00f5es","text":"<ul> <li>Verifica se <code>list_id</code> \u00e9 alfanum\u00e9rico.</li> <li>Confirma que a chave API (<code>API_KEY</code>) e a URL do Redis (<code>REDIS_URL</code>) est\u00e3o definidas, levantando exce\u00e7\u00f5es HTTP com c\u00f3digo de status 500 se alguma estiver ausente.</li> </ul>"},{"location":"routes.pt/#processamento","title":"Processamento","text":"<ol> <li>Cria\u00e7\u00e3o da Inst\u00e2ncia ClickUpAPI: Uma inst\u00e2ncia de <code>ClickUpAPI</code> \u00e9 criada com as configura\u00e7\u00f5es da API e do Redis.</li> <li>Recupera\u00e7\u00e3o de Tarefas: As tarefas s\u00e3o recuperadas da API do ClickUp.</li> <li>Filtragem de Tarefas: As tarefas s\u00e3o filtradas para extrair dados relevantes.</li> <li>Retorno dos Dados: Os dados filtrados s\u00e3o retornados como resposta ao cliente.</li> </ol>"},{"location":"routes.pt/#tratamento-de-erros","title":"Tratamento de Erros","text":"<ul> <li>Erros HTTP da API do ClickUp s\u00e3o capturados e transformados em <code>HTTPException</code> com status 500.</li> <li>Erros inesperados s\u00e3o capturados, registrados e tamb\u00e9m transformados em <code>HTTPException</code> com status 500.</li> </ul>"},{"location":"routes.pt/#exemplo-de-resposta","title":"Exemplo de Resposta","text":"<pre><code>{\n  \"data\": [\n    {\n      \"task_id\": \"12345\",\n      \"status\": \"complete\",\n      \"name\": \"Document API Endpoint\",\n      \"assignees\": [\"user1\", \"user2\"],\n      \"priority\": \"high\"\n    }\n  ]\n}\n</code></pre>"},{"location":"settings.pt/","title":"Documenta\u00e7\u00e3o do M\u00f3dulo de Configura\u00e7\u00f5es","text":"<p>Este documento detalha as vari\u00e1veis de configura\u00e7\u00e3o carregadas e utilizadas pela aplica\u00e7\u00e3o, que s\u00e3o essenciais para a conex\u00e3o com servi\u00e7os externos e para definir comportamentos espec\u00edficos do ambiente de produ\u00e7\u00e3o.</p>"},{"location":"settings.pt/#variaveis-de-configuracao","title":"Vari\u00e1veis de Configura\u00e7\u00e3o","text":""},{"location":"settings.pt/#geral","title":"Geral","text":"<ul> <li><code>API_KEY</code> (str): Chave de API usada para autentica\u00e7\u00e3o em servi\u00e7os externos.</li> </ul>"},{"location":"settings.pt/#timezone","title":"Timezone","text":"<ul> <li><code>TIMEZONE</code> (str): O fuso hor\u00e1rio utilizado pela aplica\u00e7\u00e3o. O valor padr\u00e3o \u00e9 'UTC'.</li> </ul>"},{"location":"settings.pt/#redis","title":"Redis","text":"<ul> <li><code>REDIS_URL</code> (str): A URL de conex\u00e3o com o servidor Redis.</li> </ul>"},{"location":"settings.pt/#banco-de-dados-de-producao","title":"Banco de Dados de Produ\u00e7\u00e3o","text":"<ul> <li><code>DB_HOST</code> (str): O hostname do banco de dados de produ\u00e7\u00e3o.</li> <li><code>DB_PORT</code> (str): O n\u00famero da porta para a conex\u00e3o com o banco de dados de produ\u00e7\u00e3o.</li> <li><code>DB_NAME</code> (str): O nome do banco de dados de produ\u00e7\u00e3o.</li> <li><code>DB_USER</code> (str): O nome de usu\u00e1rio utilizado para conectar ao banco de dados de produ\u00e7\u00e3o.</li> <li><code>DB_PASS</code> (str): A senha para conex\u00e3o com o banco de dados de produ\u00e7\u00e3o.</li> <li><code>DB_SCHEMA</code> (str): O esquema utilizado no banco de dados de produ\u00e7\u00e3o.</li> </ul>"},{"location":"settings.pt/#carregamento-das-configuracoes","title":"Carregamento das Configura\u00e7\u00f5es","text":"<p>No in\u00edcio do m\u00f3dulo, as configura\u00e7\u00f5es s\u00e3o carregadas a partir de um arquivo <code>.env</code> usando a biblioteca <code>dotenv</code>, que \u00e9 respons\u00e1vel por importar e disponibilizar as vari\u00e1veis de ambiente definidas no arquivo para o ambiente de execu\u00e7\u00e3o da aplica\u00e7\u00e3o.</p> <pre><code>import os\nfrom dotenv import load_dotenv\n\nload_dotenv()  # Carrega as vari\u00e1veis de ambiente do arquivo .env\n</code></pre>"}]}